# Перевод грузинских DOCX/XLSX через ChatGPT и локальные модели

Инструмент для полуавтоматического перевода грузинских документов в форматах **DOCX** и **XLSX** на **русский** или **английский** язык.  
Ориентирован на официальные документы: тарифные методики, регуляторные акты, пояснительные записки и т.п.

Поддерживаются два режима:

- ✅ **Облачный перевод через OpenAI (ChatGPT-family)**  
- ✅ **Локальный перевод через модели Helsinki-NLP (opus-mt-ka-ru / ka-en)**

Есть простой GUI на **Tkinter** с прогресс-баром, выбором модели, направлением перевода и опцией пост-редактуры текста.

---

## Возможности

- Поиск грузинского текста в:
  - DOCX: абзацы `w:p` во всех XML внутри DOCX  
  - XLSX: `xl/sharedStrings*.xml` и `xl/worksheets/*.xml`
- Перевод грузинского текста:
  - Через OpenAI Chat Completions API (ChatGPT):
    - `gpt-4.1-mini`, `gpt-4.1`, `gpt-4o-mini`, `gpt-4o`, `gpt-5.1`, `gpt-5-mini` (выбирается в GUI)
  - Через локальные модели Helsinki-NLP:
    - `Helsinki-NLP/opus-mt-ka-ru`
    - `Helsinki-NLP/opus-mt-ka-en`
- Сохранение структуры документа:
  - DOCX: работа напрямую с XML внутри DOCX (абзацы `<w:p>`, текст `<w:t>`), контроль по ID вида `word/document.xml::p17`
  - XLSX: безопасная подмена через `openpyxl` (работа с ячейками, без ломания структуры XLSX)
- Дедупликация фрагментов:
  - Один и тот же грузинский фрагмент переводится только один раз
- Опциональная **литературная вычитка** перевода через ChatGPT:
  - Улучшение стиля, юридической/технической связности, пунктуации, пробелов
- Вспомогательные функции:
  - Поиск оставшегося грузинского текста в DOCX (отладка)
  - Аккуратная правка пробелов в русском тексте (через отдельный промпт к модели)

---

## Стек и зависимости

Основные библиотеки:

- Python 3.10+ (рекомендуется)
- GUI:
  - `tkinter` (стандартная библиотека Python)
- Работа с документами:
  - `zipfile`, `xml.etree.ElementTree` (стандартная библиотека)
  - `openpyxl` — для надёжной работы с XLSX
- Облачный перевод:
  - `openai` — официальный Python-клиент OpenAI
- Локальный перевод:
  - `transformers`
  - `torch`
  - `sentencepiece`
- Прочее:
  - `re`, `json`, `os`, `threading`, `typing` — стандартная библиотека

